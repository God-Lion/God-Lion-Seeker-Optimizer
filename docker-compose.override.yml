# Docker Compose Override for Development/Testing
# This file provides additional development settings and tools

services:
  # Development-specific API configuration
  api:
    environment:
      - DEBUG=true
      - LOG_LEVEL=DEBUG
      - RELOAD=true
    volumes:
      # Enable hot-reload for development
      - ./src:/app/src:ro
    command: uvicorn src.api.main:app --host 0.0.0.0 --port 8000 --reload

  # Development database with exposed port
  postgres:
    ports:
      - "5432:5432"  # Expose for development tools
    environment:
      - POSTGRES_INITDB_ARGS=--encoding=UTF-8 --lc-collate=C --lc-ctype=C

  # Development Redis with exposed port
  redis:
    ports:
      - "6379:6379"  # Expose for development tools

  # PgAdmin for database management (development only)
  pgadmin:
    image: dpage/pgadmin4:latest
    container_name: godlionseeker-pgadmin
    environment:
      - PGADMIN_DEFAULT_EMAIL=admin@godlionseeker.local
      - PGADMIN_DEFAULT_PASSWORD=admin
      - PGADMIN_CONFIG_SERVER_MODE=False
    ports:
      - "5050:80"
    networks:
      - scraper-network
    depends_on:
      - postgres
    restart: unless-stopped

  # Redis Commander for Redis management (development only)
  redis-commander:
    image: rediscommander/redis-commander:latest
    container_name: godlionseeker-redis-commander
    environment:
      - REDIS_HOSTS=local:redis:6379
    ports:
      - "8081:8081"
    networks:
      - scraper-network
    depends_on:
      - redis
    restart: unless-stopped

  # MailDev for email testing (development only)
  maildev:
    image: maildev/maildev:latest
    container_name: godlionseeker-maildev
    ports:
      - "1025:1025"  # SMTP server
      - "1080:1080"  # Web UI
    networks:
      - scraper-network
    restart: unless-stopped
    command: --hide-extensions STARTTLS
